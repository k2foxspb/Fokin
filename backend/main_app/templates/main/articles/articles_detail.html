{% extends 'base.html' %}
{% load static %}
{% load comments %}
{% block description %}
    {{ object.preamble }}
{% endblock description %}
{% block keywords %}
    {{ object.keyword }}
{% endblock keywords %}
{% block title %}
    {{ object.title|default:"Статья" }}
{% endblock title %}
{% block content %}
    <div class="container-fluid">
        <div class="row row-cols-md-2">
            <div class="col-md-9  ">
                <div itemscope itemtype="https://schema.org/Article" class="articles-detail">
                    {% autoescape off %}
                        <h6 class="card-footer text-end" itemprop="datePublished">{{ object.created }}</h6>
                        <h1 class="card-title text-center" itemprop="headline name">{{ object.title }}</h1>

                        <h5 class="card-title text-center" itemprop="description">{{ object.preamble }}</h5>
                        {% if object.content %}

                            <div itemprop="articleBody">{{ object.content }}</div>

                        {% endif %}
                    {% endautoescape %}
                    <div class="text-end">
                        <a href="{% url 'main:main_category' %}" class="btn my-btn">Назад</a>
                        <div itemprop="publisher" itemscope itemtype="https://schema.org/Organization">
                            <div itemprop="logo" itemscope itemtype="https://schema.org/ImageObject">
                                <img itemprop="url image" src="{% static 'img/logo' %}" alt="logo" title="logo"
                                     style="display:none;"/>
                            </div>
                            <meta itemprop="name" content="https://fokin.fun/">
                            <meta itemprop="telephone" content="">
                            <meta itemprop="address" content="Россия">
                        </div>
                    </div>
                </div>
                {% get_comment_count for article as comment_count %}
                <p>количество комментариев: {{ comment_count }} </p>

                <div>

                    {% get_comment_list for article as comment_list %}
                    {% for comment in comment_list %}
                        <div class=" card shadow comments">
                            <p class="margin-left">{{ comment.user_name }} </p>
                            <p class="margin-left">{{ comment.comment }}</p>
                            <p class="del-update margin-left">{{ comment.submit_date }}</p>
                        </div>
                    {% endfor %}

                </div>

                {% if user.is_authenticated %}
                    {% get_comment_form for article as form %}
                    <form action="{% comment_form_target %}" method="POST">
                        {% csrf_token %}
                        {{ form.comment }}
                        {{ form.honeypot }}
                        {{ form.content_type }}
                        {{ form.object_pk }}
                        {{ form.timestamp }}
                        {{ form.security_hash }}
                        <input type="hidden" name="next" value="{% url 'main:article_detail' article.slug %}"/>
                        <input type="submit" value="Add comment" id="id_submit"/>
                    </form>
                {% else %}
                    <p>Please <a href="{% url 'auth_login' %}">log in</a> to leave a comment.</p>
                {% endif %}

            </div>


            {% include 'tools/menu_category.html' %}
        </div>
    </div>

{% endblock %}